take 3 server 2 master and one for haproxy

manage-> add cred

ssh username with private key

ID jenkinsha(should be same in both masters

username: something

add privatekey from the server

repeat this step in both master

create efs (nfs) and attach volumes 

login install and down nfs on server(nfs-utils)

allow ports in ec2 security groups 2049 allows

efs network in aws 2049 allow it

systemctl  stop jenkins
systemctl restart nfs-server

u will have efs mount point  when u attach through aws there you mention /var/lib/jenkins/jobs mount point there.
system start jenkins


df -h
ls -l /var/lib/jenkins/jobs
chown -R  jenkins:jenkins /var/lib/jenkins/jobs

do the same in both server

create a job freestyle helloworld and and restart the jenkins
both project will in /var/lib/jenkins/jobs and jenkins UI

INSTEAD OF RESTARTING JENKINS EVERYTIME YOU AND USE API CALLS AND USE CRON JOB

we can crumb id 
when we use crumbid go to configure global security and enable CSRF protection and enable proxy compatibility

add this to cronjob 
vi /etc/cron.d/jenkins
*/1 **** root /bin/bash /root/jenkinsreload.sh












